
GDTDefine('gdt:mod/defaultrender.js',function(require,exports,module){var comm=require('gdt:comm/comm.js');var ping=require('gdt:comm/ping.js');var DefRenderMod={};DefRenderMod.renderHelper={deftTmpl:{htmlBox:['<div class="mod-snsmarketing-slot-external">','<div class="mod-snsmarketing-slot-external-inner">','{GDTAD_CONTENTS}','</div>','</div>'].join(''),cells:{html:'<div class="snsmarketing-slot-external-box" style="width:{tw}px;">{GDTAD_CELL}</div>',flash:['<span style="width:{tw}px;height:{th}px;position:relative;display:inline-block;_zoom:1;">','<a {olink} style="filter:alpha(opacity=0);opacity:0;position:absolute;width:{tw}px;height:{th}px;left:0;top:0;background:#fff;"></a>','{GDTAD_CELL}','</span>'].join(''),txthtml:'<div class="snsmarketing-slot-external-text" style="width:{pw}px;">{GDTAD_CELL}</div>'},img:'<a {olink} class="snsmarketing-slot-external-img_link"><img src="{img}" alt="" /><span class="snsmarketing-slot-external-sign-ad"></span></a>',txt:'<div class="snsmarketing-slot-external-txt"><a {olink} class="snsmarketing-slot-external-txt-link">{txt}</a></div>',doubletxt:['<div class="text-lump" style="width: {tw}px; height: {th}px;">','<p><a {olink} class="c-link">{txt}</a></p>','<p><a {olink} class="c-word">{desc}</a></p>','<p><a {olink} class="c-url">{domain}</a></p>','</div>'].join('\r\n')},getCfg:function(config,data){config.tnum=data.length||0;config.isHtml=!!(config.pt<4);return config;},getAdHtml:function(cfg,data){var str=[],i,cellData={pid:cfg.pid,tw:cfg.tw,th:cfg.th},clsName='',h=DefRenderMod.renderHelper,adType=cfg.pt,isHtml=cfg.isHtml,cellHtml,cellstyle='',isTxt=false,isDoubleTxt=false,txtcfg,adNums=data.length||0;if(adNums===0){str=push('<!--没有广告素材-->');return str;}
txtcfg=DefRenderMod.renderHelper.getTxtCfg(cfg,data[0]);isTxt=txtcfg.isTxt;isDoubleTxt=txtcfg.isDoubleTxt;if(adNums>0){comm.each(new Array(adNums),function(v,k){var c;c=h.getAdCellStr(cfg,comm.mix(cellData,data[k]));str.push(c);});if(str.length>0&&isDoubleTxt){str.push('<div class="text-lump tuig"><a href="http://e.qq.com/" class="c-word" target="_blank">推广</a></div>');}}
if(isHtml){clsName=(adNums>1)?'snsmarketing-slot-external-two':'snsmarketing-slot-external-one';isDoubleTxt&&(clsName='snsmarketing-slot-external-text');}
cellHtml=str.join('');if(!/snsmarketing-slot-external-txt/.test(cellHtml)){cellstyle='margin-bottom : 0;';}
str=['<div class="snsmarketing-slot-external-box" style="height:',cfg.ph,'px;">','<div class="',clsName,'" style="width:',cfg.pw,'px;overflow:hidden;',cellstyle,'">',cellHtml,'</div>','</div>'].join('');return str;},getTxtCfg:function(cfg,data){var intxt,isDoubleTxt;isTxt=cfg.pt==1;isDoubleTxt=isTxt&&data&&data.desc;return{isTxt:isTxt,isDoubleTxt:isDoubleTxt}},getAdCellStr:function(cfg,data){var h=DefRenderMod.renderHelper,t=h.deftTmpl,adType=cfg.pt,regExp=/\{GDTAD_CELL\}/,isDoubleTxt=false,txtcfg,tmpl=[t.txt,t.img,t.img+t.txt],str='',tpl,flaStr,flaAttr;if(cfg.isHtml){txtcfg=h.getTxtCfg(cfg,data);isDoubleTxt=txtcfg.isDoubleTxt;tpl=tmpl[adType-1];isDoubleTxt&&(tpl=t.doubletxt);tpl=t.cells.html.replace(regExp,tpl);}else{flaAttr={width:'{tw}',height:'{th}'};if(comm.dom.ua.ie){flaAttr.classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000';}else{flaAttr.type='application/x-shockwave-flash';flaAttr.data='{img}';}
flaStr=comm.dom.buildHTML({},flaAttr,'object',(function(){var temp='<param name="{name}" value="{value}"></param>',params={movie:'{img}',wmode:'transparent'};return comm.map(params,function(v,k){return comm.format(temp,{name:k,value:v});}).join('');})());tpl=t.cells.flash.replace(regExp,flaStr);}
str=comm.format(tpl,data);return str;},render:function(cfg,data,callback){var h=DefRenderMod.renderHelper,css='//'+comm.siDomain+'/open_proj/slot-external.css',t=h.deftTmpl,cfg=h.getCfg(cfg,data),isHtml,cellsStr;isHtml=cfg.isHtml;if(isHtml){comm.css.insertCSSLink(css);fillAd(t.htmlBox);}else{fillAd();}
function fillAd(wrapper){var w=wrapper||'{GDTAD_CONTENTS}';cellsStr=h.getAdHtml(cfg,data);cfg.container&&(cfg.container.innerHTML=w.replace(/\{GDTAD_CONTENTS\}/,cellsStr));callback(true);}}};module.exports=DefRenderMod;});